# yaml-language-server: $schema=./builtin.definition.schema.json

Definitions:
  Appearance:
    SystemDarkMode:
      description: Enables dark mode for system
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize
          entries:
            - name: SystemUsesLightTheme
              type: DWord
              new_value: "0"
              old_value: "1"
    AppDarkMode:
      description: Enables dark mode for apps
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize
          entries:
            - name: AppsUseLightTheme
              type: DWord
              new_value: "0"
              old_value: "1"

  Windows:
    DisableWindowsSuggestions:
      description: Disables the Windows welcome experience, tips, scoobe experience
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager
          entries:
            # Windows welcome experience
            - name: SubscribedContent-310093Enabled
              type: DWord
              new_value: "0"
              old_value: "1"
            # Suggestions in Start
            - name: SystemPaneSuggestionsEnabled
              type: DWord
              new_value: "0"
              old_value: "1"
            # Suggestions in LockScreen
            - name: RotatingLockScreenOverlayEnabled
              type: DWord
              new_value: "0"
              old_value: "1"
        - path: HKLM\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager
          entries:
            # Windows tips
            - name: SubscribedContent-338388Enabled
              type: DWord
              new_value: "0"
              old_value: "1"
            # Windows tips
            - name: SubscribedContent-338389Enabled
              type: DWord
              new_value: "0"
              old_value: "1"
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\UserProfileEngagement
          entries:
            # Windows scoope experiencce
            - name: ScoobeSystemSettingEnabled
              type: DWord
              new_value: "0"
              old_value: "1"
    EnableWindowsRestoreLastSession:
      description: Automatically reopen some apps that were opened last time when start OS
      registries:
        - path: HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
          entries:
            - name: RestartApps
              type: DWord
              new_value: "1"
              old_value: "0"

  DesktopTaskbar:
    TaskbarAlignmentLeft:
      description: Show Taskbar Items on the Left
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: TaskbarAl
              type: DWord
              new_value: "0"
              old_value: "1"
    EnableTaskbarEndTask:
      description: Enables option to end task when right clicking a program in the taskbar
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings
          entries:
            - name: TaskbarEndTask
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    HideSearch:
      description: Hide Search Button on the taskbar.
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Search
          entries:
            - name: SearchboxTaskbarMode
              type: DWord
              new_value: "0"
              old_value: "1"
    HideTaskView:
      description: Hide Task View Button in Taskbar.
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: ShowTaskViewButton
              type: DWord
              new_value: "0"
              old_value: "1"
    HideWidgets:
      description: Hide Widgets Button from Taskbar.
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: TaskbarDa
              type: DWord
              new_value: "0"
              old_value: "1"
    RemoveCopilot:
      description: |-
        Remove Microsoft Copilot and hide it from taskbar.
        Note: Uninstalling is the only way to disable this after 23H2.
      script:
        apply: winget uninstall --name "Microsoft Copilot" --exact --source msstore
        revert: winget install --name "Microsoft Copilot" --exact --source msstore --no-upgrade --accept-package-agreements --accept-source-agreements --silent
    ShowClockSeconds:
      description: Show seconds on the taskbar clock
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: ShowSecondsInSystemClock
              type: DWord
              new_value: "1"
              old_value: "0"
    ShowMultiMonitorTaskbar:
      description: Show taskbar on multiple monitors
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: MMTaskbarEnabled
              type: DWord
              new_value: "1"
              old_value: "0"
            - name: MMTaskbarMode
              type: DWord
              new_value: "1"
              old_value: "0"
    HideDesktopRecycleBin:
      description: Hide the "Recycle Bin" icon from Desktop
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel
          entries:
            - name: "{645FF040-5081-101B-9F08-00AA002F954E}"
              type: DWord
              new_value: "1"
              old_value: "0"
    ShowSidePanelClock:
      description: Show time in Notification Center like as it in Windows 10
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: ShowClockInNotificationCenter
              type: DWord
              new_value: "1"
              old_value: "0"

  SettingsApp:
    HideSettingsSuggestions:
      description: Hide suggested content in the Settings
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager
          entries:
            - name: SubscribedContent-338393Enabled
              type: DWord
              new_value: "0"
              old_value: "1"
            - name: SubscribedContent-353694Enabled
              type: DWord
              new_value: "0"
              old_value: "1"
            - name: SubscribedContent-353696Enabled
              type: DWord
              new_value: "0"
              old_value: "1"

  StartMenu:
    DisableStartMenuBingSearch:
      description: Disables bing web search in Start Menu search.
      registries:
        - path: HKCU\Software\Policies\Microsoft\Windows\Explorer
          entries:
            - name: DisableSearchBoxSuggestions
              type: DWord
              new_value: "1"
              old_value: "0"
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Search
          entries:
            - name: BingSearchEnabled
              type: DWord
              new_value: "0"
              old_value: "1"
    HideStartMenuRecommendations:
      description: Hide recommendations in Start Menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: Start_IrisRecommendations
              type: DWord
              new_value: <NotExist>
              old_value: "1"
        - path: HKCU\Software\Policies\Microsoft\Windows\Explorer
          entries:
            - name: HideRecommendedSection
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    HideStartMenuAccountNotifications:
      description: Hide Microsoft account-related notifications in Start Menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: Start_AccountNotifications
              type: DWord
              new_value: "0"
              old_value: <NotExist>
    EnableGodMode:
      description: |-
        Create GodeMode Folder and make it searchable in Start Menu.
        Optionally you can pin it to Start Menu by manually.
      script:
        apply: |-
          $startMenuPath = "$env:AppData\Microsoft\Windows\Start Menu\Programs"
          $shortcutPath = "$startMenuPath\GodMode.lnk"
          $shortcut = (New-Object -ComObject WScript.Shell).CreateShortcut($shortcutPath)
          $shortcut.TargetPath = "explorer.exe"
          $shortcut.Arguments = "shell:::{ED7BA470-8E54-465E-825C-99712043E01C}"
          $shortcut.IconLocation = "$env:WinDir\System32\shell32.dll, 21"
          $shortcut.Save()
        revert: |-
          $startMenuPath = "$env:AppData\Microsoft\Windows\Start Menu\Programs"
          $shortcutPath = "$startMenuPath\GodMode.lnk"
          Remove-Item -Path $shortcutPath

  Explorer:
    ShowHiddenFiles:
      description: Show hidden files in explorer
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: Hidden
              type: DWord
              new_value: "1"
              old_value: "0"
    ShowFileExtensions:
      description: Show file extensions in explorer
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: HideFileExt
              type: DWord
              new_value: "0"
              old_value: "1"
    HideHome:
      description: Hide the Home from Explorer and sets This PC as default
      registries:
        - path: HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{f874310e-b6b7-47dc-bc84-b9e6b38f5903}
          new_existance: <NotExist>
          old_existance: <Exist>
          entries:
            - name: (default)
              type: String
              new_value: <NotExist>
              old_value: CLSID_MSGraphHomeFolder
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: LaunchTo
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    HideGallery:
      description: Hide the Gallery from Explorer and sets This PC as default
      registries:
        - path: HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}
          new_existance: <NotExist>
          old_existance: <Exist>
          entries:
            - name: (default)
              type: String
              new_value: <NotExist>
              old_value: "{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}"
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: LaunchTo
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    DisableOneDrive:
      description: Disables OneDrive and hide it from Explorer
      registries:
        - path: HKLM\Software\Policies\Microsoft\Windows\OneDrive
          entries:
            - name: DisableFileSyncNGSC
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    DisableGroupView:
      description: Do not group files and folder in the Downloads folder
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderTypes\{885a186e-a440-4ada-812b-db871b942259}\TopViews\{00000000-0000-0000-0000-000000000000}
          entries:
            - name: GroupBy
              type: String
              new_value: System.Null
              old_value: <NotExist>
    EnableRestoreLastSession:
      description: Restore the last session when open explroer
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: PersistBrowsers
              type: DWord
              new_value: "1"
              old_value: "0"
    DisableCheckBoxes:
      description: Do not use item check boxes
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: AutoCheckSelect
              type: DWord
              new_value: "0"
              old_value: "1"
    HideRecentFiles:
      description: Hide recently used files in Explorer Quick Access, Start Menu recommendations, and Taskbar jump lists.
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer
          entries:
            - name: ShowRecent
              type: DWord
              new_value: "0"
              old_value: "1"
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
          entries:
            - name: Start_TrackDocs
              type: DWord
              new_value: "0"
              old_value: "1"
    HideFrequentFolders:
      description: Hide frequently used folders in Explorer Quick Access
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer
          entries:
            - name: ShowFrequent
              type: DWord
              new_value: "0"
              old_value: "1"
    DisableAutoShortcutsSuffix:
      description: Do not add the "- Shortcut" suffix to the file name of created shortcuts
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\NamingTemplates
          entries:
            - name: ShortcutNameTemplate
              type: String
              new_value: "%s.lnk"
              old_value: <NotExist>

  Security:
    DisableUnsafeFileWarning:
      description:
        Disables the Attachment Manager marking files that have been downloaded
        from the Internet as unsafe
      registries:
        - path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Attachments
          entries:
            - name: SaveZoneInformation
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    DisableSmartAppControl:
      description: ""
      registries:
        - path: HKLM\System\CurrentControlSet\Control\CI\Policy
          entries:
            - name: VerifiedAndReputablePolicyState
              type: DWord
              new_value: "0"
              old_value: <NotExist>
      script:
        apply: "CiTool --refresh --json"
        revert: "CiTool --refresh --json"

  ContextMenu:
    EnableClassicContextMenu:
      description: Enables good old context menus as it was like in win10
      registries:
        - path: HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32
          new_existance: <Exist>
          old_existance: <NotExist>
          entries:
            - name: (default)
              type: String
              new_value: ""
              old_value: <NotExist>
    DisableContextMenuLimit:
      description:
        Enable the "Open", "Print", and "Edit" context menu items for more
        than 15 items selected
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer
          entries:
            - name: MultipleInvokePromptMinimum
              type: DWord
              new_value: "300"
              old_value: <NotExist>
    HideClipchamp:
      description: Hide the "Edit with Clipchamp" item from context menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{8AB635F8-9A67-4698-AB99-784AD929F3B4}"
              type: String
              new_value: ""
              old_value: <NotExist>
    HideEditWithPhotos:
      description: Hide the "Edit with Photos" item from context menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{BFE0E2A4-C70C-4AD7-AC3D-10D1ECEBB5B4}"
              type: String
              new_value: ""
              old_value: <NotExist>
    HideEditWithPaint:
      description: Hide the "Edit with Paint" item from context menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{2430F218-B743-4FD6-97BF-5C76541B4AE9}"
              type: String
              new_value: ""
              old_value: <NotExist>
    HideEditWithNotepad:
      description: Hide the "Edit with Notepad" item from context menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{CA6CC9F1-867A-481E-951E-A28C5E4F01EA}"
              type: String
              new_value: ""
              old_value: <NotExist>
    HideExtractAll:
      description: Hide the "Extract all" item from the zipped files context menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{b8cdcb65-b1bf-4b42-9428-1dfdb7ee92af}"
              type: String
              new_value: ""
              old_value: <NotExist>
            - name: "{EE07CEF5-3441-4CFB-870A-4002C724783A}"
              type: String
              new_value: ""
              old_value: <NotExist>
    HideOpenInWindowsTerminal:
      description: Hide the "Open in Windows Terminal" item from context menu
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{9F156763-7844-4DC4-B2B1-901F640F5155}"
              type: String
              new_value: ""
              old_value: <NotExist>
    HidePrint:
      description: Hide the "Print" item from context menu for .bat and .cmd files
      registries:
        - path: HKCR\batfile\shell\print
          entries:
            - name: ProgrammaticAccessOnly
              type: String
              new_value: ""
              old_value: <NotExist>
        - path: HKCR\cmdfile\shell\print
          entries:
            - name: ProgrammaticAccessOnly
              type: String
              new_value: ""
              old_value: <NotExist>
    HideCompressedFolder:
      description: Hide the "Compressed (zipped) Folder" item from the "New" context menu
      registries:
        - path: HKCR\.zip\CompressedFolder\ShellNew
          entries:
            - name: Data
              type: Binary
              new_value: <NotExist>
              old_value: "80 75 5 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"
            - name: ItemName
              type: ExpandString
              new_value: <NotExist>
              old_value: "@C:\\Windows\\System32\\zipfldr.dll,-10194"
    HideSearchMsStore:
      description: Hide the "Look for an app in the Microsoft Store" item in the "Open with" dialog
      registries:
        - path: HKLM\Software\Policies\Microsoft\Windows\Explorer
          entries:
            - name: NoUseStoreOpenWith
              type: DWord
              new_value: "1"
              old_value: <NotExist>
    HideShare:
      description: Hide the "Share" item from context menu
      registries:
        - path: HKCR\AllFilesystemObjects\ShellEx\ContextMenuHandlers\ModernSharing
          entries:
            - name: (default)
              type: String
              new_value: ""
              old_value: "{e2bf9676-5f8f-435c-97eb-11607a5bedf7}"
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{e2bf9676-5f8f-435c-97eb-11607a5bedf7}"
              type: String
              new_value: Share
              old_value: <NotExist>
    HideAddToFavorite:
      description: Hide the "Add to Favorites" item from context menu
      registries:
        - path: HKCR\*\shell\pintohomefile
          entries:
            - name: ProgrammaticAccessOnly
              type: String
              new_value: ""
              old_value: <NotExist>
    HidePreviousVersions:
      description: Hide the "Previous Versions" item from context menu
      registries:
        - path: HKCU\Software\Classes\AllFilesystemObjects
          entries:
            - name: NoPreviousVersions
              type: String
              new_value: ""
              old_value: <NotExist>
        - path: HKCU\Software\Classes\Folder
          entries:
            - name: NoPreviousVersions
              type: String
              new_value: ""
              old_value: <NotExist>
    HideSendTo:
      description: Hide the "Send To" item from context menu
      registries:
        - path: HKCR\AllFilesystemObjects\ShellEx\ContextMenuHandlers\SendTo
          new_existance: <NotExist>
          old_existance: <Exist>
    HideAddToLibrary:
      description: Hide the "Add to Library" item from context menu
      registries:
        - path: HKCR\Folder\ShellEx\ContextMenuHandlers\Library Location
          entries:
            - name: (default)
              type: String
              new_value: ""
              old_value: "{3dad6c5d-2167-4cae-9914-f99e41c12cfa}"
    HideGiveAccessTo:
      description: Hide the "Give access to" item from context menu
      registries:
        - path: HKCR\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked
          entries:
            - name: "{f81e9010-6ea4-11ce-a7ff-00aa003ca9f6}"
              type: String
              new_value: Give access to
              old_value: <NotExist>

  MouseKeyboard:
    DisableMouseAcceleration:
      description: Disables mouse acceleration
      registries:
        - path: HKCU\Control Panel\Mouse
          entries:
            - name: MouseSpeed
              type: String
              new_value: "0"
              old_value: "1"
            - name: MouseThreshold1
              type: String
              new_value: "0"
              old_value: "6"
            - name: MouseThreshold2
              type: String
              new_value: "0"
              old_value: "10"
    DisableF1HelpPage:
      description: Disable help lookup via F1
      registries:
        - path: HKCU\Software\Classes\Typelib\{8cec5860-07a1-11d9-b15e-000d56bfe6ee}\1.0\0\win64
          new_existance: <Exist>
          old_existance: <NotExist>
          entries:
            - name: (default)
              type: String
              new_value: ""
              old_value: <NotExist>
    DisableStickyShift:
      description: Turn off pressing the Shift key 5 times to turn Sticky keys
      registries:
        - path: HKCU\Control Panel\Accessibility\StickyKeys
          entries:
            - name: Flags
              type: String
              new_value: "506"
              old_value: "510"
    FastKeyRepeat:
      description: Minimize key repeat delay and Maximize key repeat rate
      registries:
        - path: HKCU\Control Panel\Keyboard
          entries:
            - name: KeyboardDelay
              type: String
              new_value: "0" # 250ms
              old_value: "1" # 500ms
            - name: KeyboardSpeed
              type: String
              new_value: "31" # 33.3ms
              old_value: "31" # 33.3ms
    DisableTouchPad:
      description: Disable touchpad for laptop
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\PrecisionTouchPad\Status
          entries:
            - name: Enabled
              type: DWord
              new_value: "0"
              old_value: "1"

  Sound:
    DisableSystemSound:
      description: Disable all system sounds
      registries:
        - path: HKCU\AppEvents\Schemes
          entries:
            - name: (Default)
              type: String
              new_value: .None
              old_value: .Default
      script:
        apply: |-
          $events = Get-ChildItem -Path "registry::HKCU\AppEvents\Schemes\Apps" | Get-ChildItem
          foreach ($event in $events) {
            $soundSet = Get-ChildItem -Path "registry::$($event.Name)"
            try {
              if (".default" -in $soundSet.PSChildName) {
                $noneSound = ""
                Set-ItemProperty -Path "registry::$($event.Name)\.current" -Name "(Default)" -Value $noneSound
              }
            } catch {}
          }
        revert: |-
          $events = Get-ChildItem -Path "registry::HKCU\AppEvents\Schemes\Apps" | Get-ChildItem
          foreach ($event in $events) {
            $soundSet = Get-ChildItem -Path "registry::$($event.Name)"
            if ( (".current" -in $soundSet.PSChildName) -and (".default" -in $soundSet.PSChildName) ) {
              try {
                $defaultSound = Get-ItemPropertyValue -Path "registry::$($event.Name)\.default" -Name "(Default)" -ErrorAction SilentlyContinue
                Set-ItemProperty -Path "registry::$($event.Name)\.current" -Name "(Default)" -Value $defaultSound
              }
              catch {}
            }
          }

  Background:
    DisableAutoDeleteTemp:
      description: Disables Storage Sense deleting temp files automatically
      registries:
        - path: HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy
          entries:
            - name: "01"
              type: DWord
              new_value: "0"
              old_value: "1"
    DisableXboxGameBar:
      description: Disable Xbox Game Bar
      registries:
        - path: HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR
          entries:
            - name: AppCaptureEnabled
              type: DWord
              new_value: "0"
              old_value: "1"
        - path: HKCU:\System\GameConfigStore
          entries:
            - name: GameDVR_Enabled
              type: DWord
              new_value: "0"
              old_value: "1"
        - path: HKCU:\Software\Microsoft\GameBar
          entries:
            - name: ShowStartupPanel
              type: DWord
              new_value: "0"
              old_value: "1"

  PowerPlan:
    EnableHighPerformancePlan:
      description: Set power plan on "High performance".
      script:
        apply: powercfg /setactive SCHEME_MIN
        revert: powercfg /setactive SCHEME_BALANCED
    DisableAutoSleep:
      description: Prevent system and monitor from going to sleep automatically
      script:
        apply: |-
          powercfg /change monitor-timeout-ac 0
          powercfg /change monitor-timeout-dc 0
          powercfg /change standby-timeout-ac 0
          powercfg /change standby-timeout-dc 0
        revert: |-
          powercfg /change monitor-timeout-ac 5
          powercfg /change monitor-timeout-dc 5
          powercfg /change standby-timeout-ac 15
          powercfg /change standby-timeout-dc 15
