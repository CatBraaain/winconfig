{
  "$defs": {
    "ExistType": {
      "const": "<Exist>",
      "type": "string"
    },
    "NotChangeType": {
      "const": "<NotChange>",
      "type": "string"
    },
    "NotExistType": {
      "const": "<NotExist>",
      "type": "string"
    },
    "RegistryEntryDefinition": {
      "additionalProperties": false,
      "description": "Represents a single registry entry value to be modified.",
      "properties": {
        "name": {
          "description": "The name of the registry value.",
          "type": "string"
        },
        "type": {
          "$ref": "#/$defs/RegistryValueKind",
          "description": "The type of the registry value."
        },
        "old_value": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "$ref": "#/$defs/NotExistType"
            }
          ],
          "description": "The default value of the registry entry."
        },
        "new_value": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "$ref": "#/$defs/NotExistType"
            }
          ],
          "description": "The desired value of the registry entry."
        }
      },
      "required": ["name", "type", "old_value", "new_value"],
      "type": "object"
    },
    "RegistryPathDefinition": {
      "additionalProperties": false,
      "description": "Represents a single registry key and entry(s) to be modified.",
      "properties": {
        "path": {
          "description": "The path to the registry key.",
          "type": "string"
        },
        "old_existance": {
          "anyOf": [
            {
              "$ref": "#/$defs/NotChangeType"
            },
            {
              "$ref": "#/$defs/ExistType"
            },
            {
              "$ref": "#/$defs/NotExistType"
            }
          ],
          "default": "<Exist>",
          "description": "The default existance of the registry key."
        },
        "new_existance": {
          "anyOf": [
            {
              "$ref": "#/$defs/NotChangeType"
            },
            {
              "$ref": "#/$defs/ExistType"
            },
            {
              "$ref": "#/$defs/NotExistType"
            }
          ],
          "default": "<Exist>",
          "description": "The desired existance of the registry key."
        },
        "entries": {
          "default": [],
          "description": "The registry entries to be modified.",
          "items": {
            "$ref": "#/$defs/RegistryEntryDefinition"
          },
          "type": "array"
        }
      },
      "required": ["path"],
      "type": "object"
    },
    "RegistryValueKind": {
      "enum": [
        "String",
        "ExpandString",
        "Binary",
        "DWord",
        "MultiString",
        "QWord"
      ],
      "type": "string"
    },
    "SchtaskDefinition": {
      "additionalProperties": false,
      "description": "Represents a scheduled task to be enabled or disabled.",
      "properties": {
        "full_path": {
          "description": "The full path of the scheduled task.",
          "type": "string"
        },
        "old_state": {
          "$ref": "#/$defs/SchtaskState",
          "description": "The default state of the scheduled task."
        },
        "new_state": {
          "$ref": "#/$defs/SchtaskState",
          "description": "The desired state of the scheduled task."
        }
      },
      "required": ["full_path", "old_state", "new_state"],
      "type": "object"
    },
    "SchtaskState": {
      "enum": ["Enabled", "Disabled"],
      "type": "string"
    },
    "ScriptDefinition": {
      "additionalProperties": false,
      "description": "Represents PowerShell scripts to be executed.",
      "properties": {
        "apply": {
          "default": "",
          "description": "The script to run for the desired configuration.",
          "type": "string"
        },
        "revert": {
          "default": "",
          "description": "The script to run for the default configuration.",
          "type": "string"
        }
      },
      "type": "object"
    },
    "ServiceDefinition": {
      "additionalProperties": false,
      "description": "Represents a Windows service to be modified.",
      "properties": {
        "name": {
          "description": "The name of the service.",
          "type": "string"
        },
        "old_startup": {
          "$ref": "#/$defs/ServiceStartupType",
          "description": "The default startup type of the service."
        },
        "new_startup": {
          "$ref": "#/$defs/ServiceStartupType",
          "description": "The desired startup type of the service."
        }
      },
      "required": ["name", "old_startup", "new_startup"],
      "type": "object"
    },
    "ServiceStartupType": {
      "enum": [
        "Automatic",
        "AutomaticDelayedStart",
        "Disabled",
        "InvalidValue",
        "Manual"
      ],
      "type": "string"
    },
    "TaskDefinitionBody": {
      "additionalProperties": false,
      "anyOf": [
        {
          "required": ["registries"]
        },
        {
          "required": ["scheduled_tasks"]
        },
        {
          "required": ["services"]
        },
        {
          "required": ["script"]
        }
      ],
      "description": "A single, self-contained configuration task.",
      "properties": {
        "description": {
          "description": "A description of the task's purpose.",
          "type": "string"
        },
        "registries": {
          "default": [],
          "description": "The registry values to be modified.",
          "items": {
            "$ref": "#/$defs/RegistryPathDefinition"
          },
          "type": "array"
        },
        "scheduled_tasks": {
          "default": [],
          "description": "The scheduled tasks to be modified.",
          "items": {
            "$ref": "#/$defs/SchtaskDefinition"
          },
          "type": "array"
        },
        "services": {
          "default": [],
          "description": "The Windows services to be modified.",
          "items": {
            "$ref": "#/$defs/ServiceDefinition"
          },
          "type": "array"
        },
        "script": {
          "$ref": "#/$defs/ScriptDefinition",
          "default": {
            "apply": "",
            "revert": ""
          },
          "description": "Custom PowerShell scripts for actions not covered by registry, services, or scheduled tasks."
        }
      },
      "required": ["description"],
      "type": "object"
    }
  },
  "additionalProperties": {
    "$ref": "#/$defs/TaskDefinitionBody"
  },
  "default": {},
  "description": "The root model for a winconfig definition file.",
  "type": "object"
}
